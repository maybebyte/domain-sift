# Copyright (c) 2023-2025 Ashlen <dev@anthes.is>
#
# Permission to use, copy, modify, and distribute this software for any
# purpose with or without fee is hereby granted, provided that the above
# copyright notice and this permission notice appear in all copies.
#
# THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
# WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
# MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
# ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
# WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
# ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
# OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

package Domain::Sift::Match;
use v5.36;
use English;

=head1 NAME

Domain::Sift::Match - tools that match domains inside strings

=head1 SYNOPSIS

Domain::Sift::Match offers a set of methods for matching domains.

    use Domain::Sift::Match;

    my $sift_match = Domain::Sift::Match->new();
    my $example_domain = 'example.com';

    my $is_valid_tld = $sift_match->has_valid_tld($example_domain);
    my $valid_domain = $sift_match->contains_domain($example_domain);

    # Extract all domains from text
    my @all_domains = $sift_match->contains_domains($text);
    my @extracted = $sift_match->extract_domains($line);

=head1 SUBROUTINES/METHODS

=head2 new

    my $sift_match = Domain::Sift::Match->new();

Creates a new instance of the Domain::Sift::Match class. This instance
contains a list of valid top-level domains.

=cut

# Defined at the end of the file due to length.
# Keep in sync with https://data.iana.org/TLD/tlds-alpha-by-domain.txt
my %valid_tlds;

# IMPORTANT: /p modifier is required for ${^MATCH} to capture matched text.
# Removing /p will cause contains_domain() and contains_domains() to return
# empty strings instead of the matched domain.
#
# Package-level pattern compiled once at module load for performance.
# Used by contains_domain() and contains_domains().
our $DOMAIN_PATTERN = qr/

	# word boundary ensures we're at the beginning of a domain
	\b

	# BEGIN domain group
	(

		# Lookahead asserts that the upcoming domain leaf contains
		# 1-63 allowed characters before a dot
		(?= [a-z 0-9 _-]{1,63} \.)

		# Domain label: optional underscore (RFC 8552), then alphanumeric
		_? [a-z 0-9]+

		# The rest of the leaf can contain hyphens between
		# letters or digits (underscores only at label start)
		([-]+ [a-z 0-9]+)*

		# Each domain leaf ends with a dot
		\.

	# One or more domain groups
	)+

	# BEGIN Top Level Domain (TLD) group
	(

		# Punycode TLD starts with 'xn--' and is followed by 2-59
		# allowed characters
		(xn-- [a-z 0-9]{2,59})
		|
		# Alternatively, use a regular TLD that has 2-63 letters
		[a-z]{2,63}

	# END TLD group
	)

	# word boundary ensures we're at the end of a domain
	\b

/paaxxni;

sub new ($class) {
	my $self = { valid_tlds => \%valid_tlds };
	return bless $self, $class;
}

=head2 has_valid_tld

    my $is_valid_tld = $sift_match->has_valid_tld($example_domain);

Checks the validity of a given domain's TLD. This function extracts the
TLD from the domain and verifies its presence in the list of valid TLDs.

=cut

# Regular expressions are avoided here due to their performance cost.
sub has_valid_tld ( $self, $domain ){
	my $tld = substr $domain, rindex( $domain, '.' ) + 1;
	return exists $self->{valid_tlds}{ uc($tld) }
}

# RFC 8552: Underscores allowed only at label start (service records)
# Valid: _dmarc.example.com, _443._tcp.example.com
# Invalid: foo_bar.example.com (mid-label), __dmarc.example.com (double)
sub _has_invalid_underscore ($domain) {
	return 1 if $domain =~ /__/;                   # Double underscore
	return 1 if $domain =~ /[a-z0-9]_[a-z0-9]/i;   # Mid-label underscore
	return 1 if $domain =~ /_\./;                  # Lone underscore OR trailing before dot
	return 1 if $domain =~ /[a-z0-9-]_$/i;         # Trailing underscore at end
	return 1 if $domain =~ /(?:^|\.)_-/;           # Underscore-hyphen at label start
	return 1 if $domain =~ /-_/;                   # Hyphen-underscore sequence
	return 0;
}

=head2 contains_domain

    my $valid_domain = $sift_match->contains_domain($example_domain);

Evaluates if a provided string is a valid domain name. contains_domain applies
pattern matching to confirm that the domain is formatted correctly and
checks the top-level domain (TLD) against a preloaded list of valid
TLDs. Returns the domain if the string matches the established domain
pattern and has a valid TLD. Otherwise contains_domain returns undef.

=cut

sub contains_domain ( $self, $text ) {
	if ( $text =~ /$DOMAIN_PATTERN/p ) {
		my $match = ${^MATCH};
		my $pos = $-[0];  # Match start position

		# Check for lone underscore label preceding match (_.example.com)
		return if $pos >= 2 && substr($text, $pos - 2, 2) eq '_.';

		# Check for mid-label underscore immediately preceding match
		# The regex backtracks past mid-label underscores, extracting partial domain
		# E.g., foo_bar.example.com -> regex matches bar.example.com
		return if $pos >= 1 && substr($text, $pos - 1, 1) eq '_';

		# Check for hyphen-underscore boundary (e.g., _foo-_bar.example.com)
		# Match starts with _ and preceding char is -
		return if $pos >= 1 && substr($text, $pos, 1) eq '_'
		                    && substr($text, $pos - 1, 1) eq '-';

		# STRICT: Scan entire prefix for invalid underscore patterns
		# Catches cases where regex backtracked past invalid patterns
		if ($pos > 0) {
			my $prefix = substr($text, 0, $pos);
			return if _has_invalid_underscore($prefix);
		}

		return if _has_invalid_underscore($match);
		return $match if $self->has_valid_tld($match);
	}
	return;
}

=head2 contains_domains

    my @valid_domains = $sift_match->contains_domains($text);

Returns all valid domains found in the given text. Unlike contains_domain
which returns only the first match, this method returns a list of all
domains with valid TLDs.

Duplicate domains within the same text are preserved in the order they
appear. This allows the caller to perform frequency analysis if needed.
Most use cases will deduplicate via a hash.

Returns an empty list if no valid domains are found.

=cut

sub contains_domains ( $self, $text ) {
	my @domains;
	while ( $text =~ /$DOMAIN_PATTERN/g ) {
		push @domains, ${^MATCH} if $self->has_valid_tld(${^MATCH});
	}
	return @domains;
}

=head2 extract_domain

    my $extracted_domain = $sift_match->extract_domain($example_line);

Extracts and returns a domain from a given line of text, if present. It
ignores comments and blank lines and skips lines containing certain IP
addresses. Domain names are treated as case-insensitive.

=cut

sub extract_domain ( $self, $line ) {
	chomp $line;
	$line =~ s/\r\z//;  # Handle Windows line endings on Unix

	return if $line =~ /\A \s* (\#|\z)/aaxxn;
	$line =~ s/\A \s* (127\.0\.0\.1|0\.0\.0\.0) \s*//aaxxn;
	return if $line =~ /\B (127\.0\.0\.1|0\.0\.0\.0)/aaxxn;

	return $self->contains_domain( lc($line) );
}

=head2 extract_domains

    my @extracted_domains = $sift_match->extract_domains($line);

Extracts and returns all domains from a given line of text. Like
extract_domain, it ignores comments and blank lines and handles
IP addresses, but returns all valid domains instead of just the first.

=cut

sub extract_domains ( $self, $line ) {
	chomp $line;
	$line =~ s/\r\z//;  # Handle Windows line endings on Unix

	return if $line =~ /\A \s* (\#|\z)/aaxxn;
	$line =~ s/\A \s* (127\.0\.0\.1|0\.0\.0\.0) \s*//aaxxn;
	return if $line =~ /\B (127\.0\.0\.1|0\.0\.0\.0)/aaxxn;

	return $self->contains_domains( lc($line) );
}

=head1 AUTHOR

Created and maintained by Ashlen <dev@anthes.is>

=head1 SEE ALSO

RFC 1034, Domain names - concepts and facilities

RFC 2181, Clarifications to the DNS Specification

IANA top-level domains list
https://data.iana.org/TLD/tlds-alpha-by-domain.txt

=head1 LICENSE AND COPYRIGHT

This software is Copyright (c) 2023-2025 by Ashlen.

This is free software, licensed under the ISC license.

=cut

# Upstream maintains these in uppercase.
%valid_tlds = map { ( $ARG => 1 ) } (
	'AAA',
	'AARP',
	'ABB',
	'ABBOTT',
	'ABBVIE',
	'ABC',
	'ABLE',
	'ABOGADO',
	'ABUDHABI',
	'AC',
	'ACADEMY',
	'ACCENTURE',
	'ACCOUNTANT',
	'ACCOUNTANTS',
	'ACO',
	'ACTOR',
	'AD',
	'ADS',
	'ADULT',
	'AE',
	'AEG',
	'AERO',
	'AETNA',
	'AF',
	'AFL',
	'AFRICA',
	'AG',
	'AGAKHAN',
	'AGENCY',
	'AI',
	'AIG',
	'AIRBUS',
	'AIRFORCE',
	'AIRTEL',
	'AKDN',
	'AL',
	'ALIBABA',
	'ALIPAY',
	'ALLFINANZ',
	'ALLSTATE',
	'ALLY',
	'ALSACE',
	'ALSTOM',
	'AM',
	'AMAZON',
	'AMERICANEXPRESS',
	'AMERICANFAMILY',
	'AMEX',
	'AMFAM',
	'AMICA',
	'AMSTERDAM',
	'ANALYTICS',
	'ANDROID',
	'ANQUAN',
	'ANZ',
	'AO',
	'AOL',
	'APARTMENTS',
	'APP',
	'APPLE',
	'AQ',
	'AQUARELLE',
	'AR',
	'ARAB',
	'ARAMCO',
	'ARCHI',
	'ARMY',
	'ARPA',
	'ART',
	'ARTE',
	'AS',
	'ASDA',
	'ASIA',
	'ASSOCIATES',
	'AT',
	'ATHLETA',
	'ATTORNEY',
	'AU',
	'AUCTION',
	'AUDI',
	'AUDIBLE',
	'AUDIO',
	'AUSPOST',
	'AUTHOR',
	'AUTO',
	'AUTOS',
	'AW',
	'AWS',
	'AX',
	'AXA',
	'AZ',
	'AZURE',
	'BA',
	'BABY',
	'BAIDU',
	'BANAMEX',
	'BAND',
	'BANK',
	'BAR',
	'BARCELONA',
	'BARCLAYCARD',
	'BARCLAYS',
	'BAREFOOT',
	'BARGAINS',
	'BASEBALL',
	'BASKETBALL',
	'BAUHAUS',
	'BAYERN',
	'BB',
	'BBC',
	'BBT',
	'BBVA',
	'BCG',
	'BCN',
	'BD',
	'BE',
	'BEATS',
	'BEAUTY',
	'BEER',
	'BENTLEY',
	'BERLIN',
	'BEST',
	'BESTBUY',
	'BET',
	'BF',
	'BG',
	'BH',
	'BHARTI',
	'BI',
	'BIBLE',
	'BID',
	'BIKE',
	'BING',
	'BINGO',
	'BIO',
	'BIZ',
	'BJ',
	'BLACK',
	'BLACKFRIDAY',
	'BLOCKBUSTER',
	'BLOG',
	'BLOOMBERG',
	'BLUE',
	'BM',
	'BMS',
	'BMW',
	'BN',
	'BNPPARIBAS',
	'BO',
	'BOATS',
	'BOEHRINGER',
	'BOFA',
	'BOM',
	'BOND',
	'BOO',
	'BOOK',
	'BOOKING',
	'BOSCH',
	'BOSTIK',
	'BOSTON',
	'BOT',
	'BOUTIQUE',
	'BOX',
	'BR',
	'BRADESCO',
	'BRIDGESTONE',
	'BROADWAY',
	'BROKER',
	'BROTHER',
	'BRUSSELS',
	'BS',
	'BT',
	'BUILD',
	'BUILDERS',
	'BUSINESS',
	'BUY',
	'BUZZ',
	'BV',
	'BW',
	'BY',
	'BZ',
	'BZH',
	'CA',
	'CAB',
	'CAFE',
	'CAL',
	'CALL',
	'CALVINKLEIN',
	'CAM',
	'CAMERA',
	'CAMP',
	'CANON',
	'CAPETOWN',
	'CAPITAL',
	'CAPITALONE',
	'CAR',
	'CARAVAN',
	'CARDS',
	'CARE',
	'CAREER',
	'CAREERS',
	'CARS',
	'CASA',
	'CASE',
	'CASH',
	'CASINO',
	'CAT',
	'CATERING',
	'CATHOLIC',
	'CBA',
	'CBN',
	'CBRE',
	'CC',
	'CD',
	'CENTER',
	'CEO',
	'CERN',
	'CF',
	'CFA',
	'CFD',
	'CG',
	'CH',
	'CHANEL',
	'CHANNEL',
	'CHARITY',
	'CHASE',
	'CHAT',
	'CHEAP',
	'CHINTAI',
	'CHRISTMAS',
	'CHROME',
	'CHURCH',
	'CI',
	'CIPRIANI',
	'CIRCLE',
	'CISCO',
	'CITADEL',
	'CITI',
	'CITIC',
	'CITY',
	'CK',
	'CL',
	'CLAIMS',
	'CLEANING',
	'CLICK',
	'CLINIC',
	'CLINIQUE',
	'CLOTHING',
	'CLOUD',
	'CLUB',
	'CLUBMED',
	'CM',
	'CN',
	'CO',
	'COACH',
	'CODES',
	'COFFEE',
	'COLLEGE',
	'COLOGNE',
	'COM',
	'COMMBANK',
	'COMMUNITY',
	'COMPANY',
	'COMPARE',
	'COMPUTER',
	'COMSEC',
	'CONDOS',
	'CONSTRUCTION',
	'CONSULTING',
	'CONTACT',
	'CONTRACTORS',
	'COOKING',
	'COOL',
	'COOP',
	'CORSICA',
	'COUNTRY',
	'COUPON',
	'COUPONS',
	'COURSES',
	'CPA',
	'CR',
	'CREDIT',
	'CREDITCARD',
	'CREDITUNION',
	'CRICKET',
	'CROWN',
	'CRS',
	'CRUISE',
	'CRUISES',
	'CU',
	'CUISINELLA',
	'CV',
	'CW',
	'CX',
	'CY',
	'CYMRU',
	'CYOU',
	'CZ',
	'DABUR',
	'DAD',
	'DANCE',
	'DATA',
	'DATE',
	'DATING',
	'DATSUN',
	'DAY',
	'DCLK',
	'DDS',
	'DE',
	'DEAL',
	'DEALER',
	'DEALS',
	'DEGREE',
	'DELIVERY',
	'DELL',
	'DELOITTE',
	'DELTA',
	'DEMOCRAT',
	'DENTAL',
	'DENTIST',
	'DESI',
	'DESIGN',
	'DEV',
	'DHL',
	'DIAMONDS',
	'DIET',
	'DIGITAL',
	'DIRECT',
	'DIRECTORY',
	'DISCOUNT',
	'DISCOVER',
	'DISH',
	'DIY',
	'DJ',
	'DK',
	'DM',
	'DNP',
	'DO',
	'DOCS',
	'DOCTOR',
	'DOG',
	'DOMAINS',
	'DOT',
	'DOWNLOAD',
	'DRIVE',
	'DTV',
	'DUBAI',
	'DUNLOP',
	'DUPONT',
	'DURBAN',
	'DVAG',
	'DVR',
	'DZ',
	'EARTH',
	'EAT',
	'EC',
	'ECO',
	'EDEKA',
	'EDU',
	'EDUCATION',
	'EE',
	'EG',
	'EMAIL',
	'EMERCK',
	'ENERGY',
	'ENGINEER',
	'ENGINEERING',
	'ENTERPRISES',
	'EPSON',
	'EQUIPMENT',
	'ER',
	'ERICSSON',
	'ERNI',
	'ES',
	'ESQ',
	'ESTATE',
	'ET',
	'EU',
	'EUROVISION',
	'EUS',
	'EVENTS',
	'EXCHANGE',
	'EXPERT',
	'EXPOSED',
	'EXPRESS',
	'EXTRASPACE',
	'FAGE',
	'FAIL',
	'FAIRWINDS',
	'FAITH',
	'FAMILY',
	'FAN',
	'FANS',
	'FARM',
	'FARMERS',
	'FASHION',
	'FAST',
	'FEDEX',
	'FEEDBACK',
	'FERRARI',
	'FERRERO',
	'FI',
	'FIDELITY',
	'FIDO',
	'FILM',
	'FINAL',
	'FINANCE',
	'FINANCIAL',
	'FIRE',
	'FIRESTONE',
	'FIRMDALE',
	'FISH',
	'FISHING',
	'FIT',
	'FITNESS',
	'FJ',
	'FK',
	'FLICKR',
	'FLIGHTS',
	'FLIR',
	'FLORIST',
	'FLOWERS',
	'FLY',
	'FM',
	'FO',
	'FOO',
	'FOOD',
	'FOOTBALL',
	'FORD',
	'FOREX',
	'FORSALE',
	'FORUM',
	'FOUNDATION',
	'FOX',
	'FR',
	'FREE',
	'FRESENIUS',
	'FRL',
	'FROGANS',
	'FRONTIER',
	'FTR',
	'FUJITSU',
	'FUN',
	'FUND',
	'FURNITURE',
	'FUTBOL',
	'FYI',
	'GA',
	'GAL',
	'GALLERY',
	'GALLO',
	'GALLUP',
	'GAME',
	'GAMES',
	'GAP',
	'GARDEN',
	'GAY',
	'GB',
	'GBIZ',
	'GD',
	'GDN',
	'GE',
	'GEA',
	'GENT',
	'GENTING',
	'GEORGE',
	'GF',
	'GG',
	'GGEE',
	'GH',
	'GI',
	'GIFT',
	'GIFTS',
	'GIVES',
	'GIVING',
	'GL',
	'GLASS',
	'GLE',
	'GLOBAL',
	'GLOBO',
	'GM',
	'GMAIL',
	'GMBH',
	'GMO',
	'GMX',
	'GN',
	'GODADDY',
	'GOLD',
	'GOLDPOINT',
	'GOLF',
	'GOO',
	'GOODYEAR',
	'GOOG',
	'GOOGLE',
	'GOP',
	'GOT',
	'GOV',
	'GP',
	'GQ',
	'GR',
	'GRAINGER',
	'GRAPHICS',
	'GRATIS',
	'GREEN',
	'GRIPE',
	'GROCERY',
	'GROUP',
	'GS',
	'GT',
	'GU',
	'GUCCI',
	'GUGE',
	'GUIDE',
	'GUITARS',
	'GURU',
	'GW',
	'GY',
	'HAIR',
	'HAMBURG',
	'HANGOUT',
	'HAUS',
	'HBO',
	'HDFC',
	'HDFCBANK',
	'HEALTH',
	'HEALTHCARE',
	'HELP',
	'HELSINKI',
	'HERE',
	'HERMES',
	'HIPHOP',
	'HISAMITSU',
	'HITACHI',
	'HIV',
	'HK',
	'HKT',
	'HM',
	'HN',
	'HOCKEY',
	'HOLDINGS',
	'HOLIDAY',
	'HOMEDEPOT',
	'HOMEGOODS',
	'HOMES',
	'HOMESENSE',
	'HONDA',
	'HORSE',
	'HOSPITAL',
	'HOST',
	'HOSTING',
	'HOT',
	'HOTELS',
	'HOTMAIL',
	'HOUSE',
	'HOW',
	'HR',
	'HSBC',
	'HT',
	'HU',
	'HUGHES',
	'HYATT',
	'HYUNDAI',
	'IBM',
	'ICBC',
	'ICE',
	'ICU',
	'ID',
	'IE',
	'IEEE',
	'IFM',
	'IKANO',
	'IL',
	'IM',
	'IMAMAT',
	'IMDB',
	'IMMO',
	'IMMOBILIEN',
	'IN',
	'INC',
	'INDUSTRIES',
	'INFINITI',
	'INFO',
	'ING',
	'INK',
	'INSTITUTE',
	'INSURANCE',
	'INSURE',
	'INT',
	'INTERNATIONAL',
	'INTUIT',
	'INVESTMENTS',
	'IO',
	'IPIRANGA',
	'IQ',
	'IR',
	'IRISH',
	'IS',
	'ISMAILI',
	'IST',
	'ISTANBUL',
	'IT',
	'ITAU',
	'ITV',
	'JAGUAR',
	'JAVA',
	'JCB',
	'JE',
	'JEEP',
	'JETZT',
	'JEWELRY',
	'JIO',
	'JLL',
	'JM',
	'JMP',
	'JNJ',
	'JO',
	'JOBS',
	'JOBURG',
	'JOT',
	'JOY',
	'JP',
	'JPMORGAN',
	'JPRS',
	'JUEGOS',
	'JUNIPER',
	'KAUFEN',
	'KDDI',
	'KE',
	'KERRYHOTELS',
	'KERRYLOGISTICS',
	'KERRYPROPERTIES',
	'KFH',
	'KG',
	'KH',
	'KI',
	'KIA',
	'KIDS',
	'KIM',
	'KINDLE',
	'KITCHEN',
	'KIWI',
	'KM',
	'KN',
	'KOELN',
	'KOMATSU',
	'KOSHER',
	'KP',
	'KPMG',
	'KPN',
	'KR',
	'KRD',
	'KRED',
	'KUOKGROUP',
	'KW',
	'KY',
	'KYOTO',
	'KZ',
	'LA',
	'LACAIXA',
	'LAMBORGHINI',
	'LAMER',
	'LANCASTER',
	'LAND',
	'LANDROVER',
	'LANXESS',
	'LASALLE',
	'LAT',
	'LATINO',
	'LATROBE',
	'LAW',
	'LAWYER',
	'LB',
	'LC',
	'LDS',
	'LEASE',
	'LECLERC',
	'LEFRAK',
	'LEGAL',
	'LEGO',
	'LEXUS',
	'LGBT',
	'LI',
	'LIDL',
	'LIFE',
	'LIFEINSURANCE',
	'LIFESTYLE',
	'LIGHTING',
	'LIKE',
	'LILLY',
	'LIMITED',
	'LIMO',
	'LINCOLN',
	'LINK',
	'LIPSY',
	'LIVE',
	'LIVING',
	'LK',
	'LLC',
	'LLP',
	'LOAN',
	'LOANS',
	'LOCKER',
	'LOCUS',
	'LOL',
	'LONDON',
	'LOTTE',
	'LOTTO',
	'LOVE',
	'LPL',
	'LPLFINANCIAL',
	'LR',
	'LS',
	'LT',
	'LTD',
	'LTDA',
	'LU',
	'LUNDBECK',
	'LUXE',
	'LUXURY',
	'LV',
	'LY',
	'MA',
	'MADRID',
	'MAIF',
	'MAISON',
	'MAKEUP',
	'MAN',
	'MANAGEMENT',
	'MANGO',
	'MAP',
	'MARKET',
	'MARKETING',
	'MARKETS',
	'MARRIOTT',
	'MARSHALLS',
	'MATTEL',
	'MBA',
	'MC',
	'MCKINSEY',
	'MD',
	'ME',
	'MED',
	'MEDIA',
	'MEET',
	'MELBOURNE',
	'MEME',
	'MEMORIAL',
	'MEN',
	'MENU',
	'MERCKMSD',
	'MG',
	'MH',
	'MIAMI',
	'MICROSOFT',
	'MIL',
	'MINI',
	'MINT',
	'MIT',
	'MITSUBISHI',
	'MK',
	'ML',
	'MLB',
	'MLS',
	'MM',
	'MMA',
	'MN',
	'MO',
	'MOBI',
	'MOBILE',
	'MODA',
	'MOE',
	'MOI',
	'MOM',
	'MONASH',
	'MONEY',
	'MONSTER',
	'MORMON',
	'MORTGAGE',
	'MOSCOW',
	'MOTO',
	'MOTORCYCLES',
	'MOV',
	'MOVIE',
	'MP',
	'MQ',
	'MR',
	'MS',
	'MSD',
	'MT',
	'MTN',
	'MTR',
	'MU',
	'MUSEUM',
	'MUSIC',
	'MV',
	'MW',
	'MX',
	'MY',
	'MZ',
	'NA',
	'NAB',
	'NAGOYA',
	'NAME',
	'NAVY',
	'NBA',
	'NC',
	'NE',
	'NEC',
	'NET',
	'NETBANK',
	'NETFLIX',
	'NETWORK',
	'NEUSTAR',
	'NEW',
	'NEWS',
	'NEXT',
	'NEXTDIRECT',
	'NEXUS',
	'NF',
	'NFL',
	'NG',
	'NGO',
	'NHK',
	'NI',
	'NICO',
	'NIKE',
	'NIKON',
	'NINJA',
	'NISSAN',
	'NISSAY',
	'NL',
	'NO',
	'NOKIA',
	'NORTON',
	'NOW',
	'NOWRUZ',
	'NOWTV',
	'NP',
	'NR',
	'NRA',
	'NRW',
	'NTT',
	'NU',
	'NYC',
	'NZ',
	'OBI',
	'OBSERVER',
	'OFFICE',
	'OKINAWA',
	'OLAYAN',
	'OLAYANGROUP',
	'OLLO',
	'OM',
	'OMEGA',
	'ONE',
	'ONG',
	'ONL',
	'ONLINE',
	'OOO',
	'OPEN',
	'ORACLE',
	'ORANGE',
	'ORG',
	'ORGANIC',
	'ORIGINS',
	'OSAKA',
	'OTSUKA',
	'OTT',
	'OVH',
	'PA',
	'PAGE',
	'PANASONIC',
	'PARIS',
	'PARS',
	'PARTNERS',
	'PARTS',
	'PARTY',
	'PAY',
	'PCCW',
	'PE',
	'PET',
	'PF',
	'PFIZER',
	'PG',
	'PH',
	'PHARMACY',
	'PHD',
	'PHILIPS',
	'PHONE',
	'PHOTO',
	'PHOTOGRAPHY',
	'PHOTOS',
	'PHYSIO',
	'PICS',
	'PICTET',
	'PICTURES',
	'PID',
	'PIN',
	'PING',
	'PINK',
	'PIONEER',
	'PIZZA',
	'PK',
	'PL',
	'PLACE',
	'PLAY',
	'PLAYSTATION',
	'PLUMBING',
	'PLUS',
	'PM',
	'PN',
	'PNC',
	'POHL',
	'POKER',
	'POLITIE',
	'PORN',
	'POST',
	'PR',
	'PRAMERICA',
	'PRAXI',
	'PRESS',
	'PRIME',
	'PRO',
	'PROD',
	'PRODUCTIONS',
	'PROF',
	'PROGRESSIVE',
	'PROMO',
	'PROPERTIES',
	'PROPERTY',
	'PROTECTION',
	'PRU',
	'PRUDENTIAL',
	'PS',
	'PT',
	'PUB',
	'PW',
	'PWC',
	'PY',
	'QA',
	'QPON',
	'QUEBEC',
	'QUEST',
	'RACING',
	'RADIO',
	'RE',
	'READ',
	'REALESTATE',
	'REALTOR',
	'REALTY',
	'RECIPES',
	'RED',
	'REDSTONE',
	'REDUMBRELLA',
	'REHAB',
	'REISE',
	'REISEN',
	'REIT',
	'RELIANCE',
	'REN',
	'RENT',
	'RENTALS',
	'REPAIR',
	'REPORT',
	'REPUBLICAN',
	'REST',
	'RESTAURANT',
	'REVIEW',
	'REVIEWS',
	'REXROTH',
	'RICH',
	'RICHARDLI',
	'RICOH',
	'RIL',
	'RIO',
	'RIP',
	'RO',
	'ROCKS',
	'RODEO',
	'ROGERS',
	'ROOM',
	'RS',
	'RSVP',
	'RU',
	'RUGBY',
	'RUHR',
	'RUN',
	'RW',
	'RWE',
	'RYUKYU',
	'SA',
	'SAARLAND',
	'SAFE',
	'SAFETY',
	'SAKURA',
	'SALE',
	'SALON',
	'SAMSCLUB',
	'SAMSUNG',
	'SANDVIK',
	'SANDVIKCOROMANT',
	'SANOFI',
	'SAP',
	'SARL',
	'SAS',
	'SAVE',
	'SAXO',
	'SB',
	'SBI',
	'SBS',
	'SC',
	'SCB',
	'SCHAEFFLER',
	'SCHMIDT',
	'SCHOLARSHIPS',
	'SCHOOL',
	'SCHULE',
	'SCHWARZ',
	'SCIENCE',
	'SCOT',
	'SD',
	'SE',
	'SEARCH',
	'SEAT',
	'SECURE',
	'SECURITY',
	'SEEK',
	'SELECT',
	'SENER',
	'SERVICES',
	'SEVEN',
	'SEW',
	'SEX',
	'SEXY',
	'SFR',
	'SG',
	'SH',
	'SHANGRILA',
	'SHARP',
	'SHELL',
	'SHIA',
	'SHIKSHA',
	'SHOES',
	'SHOP',
	'SHOPPING',
	'SHOUJI',
	'SHOW',
	'SI',
	'SILK',
	'SINA',
	'SINGLES',
	'SITE',
	'SJ',
	'SK',
	'SKI',
	'SKIN',
	'SKY',
	'SKYPE',
	'SL',
	'SLING',
	'SM',
	'SMART',
	'SMILE',
	'SN',
	'SNCF',
	'SO',
	'SOCCER',
	'SOCIAL',
	'SOFTBANK',
	'SOFTWARE',
	'SOHU',
	'SOLAR',
	'SOLUTIONS',
	'SONG',
	'SONY',
	'SOY',
	'SPA',
	'SPACE',
	'SPORT',
	'SPOT',
	'SR',
	'SRL',
	'SS',
	'ST',
	'STADA',
	'STAPLES',
	'STAR',
	'STATEBANK',
	'STATEFARM',
	'STC',
	'STCGROUP',
	'STOCKHOLM',
	'STORAGE',
	'STORE',
	'STREAM',
	'STUDIO',
	'STUDY',
	'STYLE',
	'SU',
	'SUCKS',
	'SUPPLIES',
	'SUPPLY',
	'SUPPORT',
	'SURF',
	'SURGERY',
	'SUZUKI',
	'SV',
	'SWATCH',
	'SWISS',
	'SX',
	'SY',
	'SYDNEY',
	'SYSTEMS',
	'SZ',
	'TAB',
	'TAIPEI',
	'TALK',
	'TAOBAO',
	'TARGET',
	'TATAMOTORS',
	'TATAR',
	'TATTOO',
	'TAX',
	'TAXI',
	'TC',
	'TCI',
	'TD',
	'TDK',
	'TEAM',
	'TECH',
	'TECHNOLOGY',
	'TEL',
	'TEMASEK',
	'TENNIS',
	'TEVA',
	'TF',
	'TG',
	'TH',
	'THD',
	'THEATER',
	'THEATRE',
	'TIAA',
	'TICKETS',
	'TIENDA',
	'TIPS',
	'TIRES',
	'TIROL',
	'TJ',
	'TJMAXX',
	'TJX',
	'TK',
	'TKMAXX',
	'TL',
	'TM',
	'TMALL',
	'TN',
	'TO',
	'TODAY',
	'TOKYO',
	'TOOLS',
	'TOP',
	'TORAY',
	'TOSHIBA',
	'TOTAL',
	'TOURS',
	'TOWN',
	'TOYOTA',
	'TOYS',
	'TR',
	'TRADE',
	'TRADING',
	'TRAINING',
	'TRAVEL',
	'TRAVELERS',
	'TRAVELERSINSURANCE',
	'TRUST',
	'TRV',
	'TT',
	'TUBE',
	'TUI',
	'TUNES',
	'TUSHU',
	'TV',
	'TVS',
	'TW',
	'TZ',
	'UA',
	'UBANK',
	'UBS',
	'UG',
	'UK',
	'UNICOM',
	'UNIVERSITY',
	'UNO',
	'UOL',
	'UPS',
	'US',
	'UY',
	'UZ',
	'VA',
	'VACATIONS',
	'VANA',
	'VANGUARD',
	'VC',
	'VE',
	'VEGAS',
	'VENTURES',
	'VERISIGN',
	'VERSICHERUNG',
	'VET',
	'VG',
	'VI',
	'VIAJES',
	'VIDEO',
	'VIG',
	'VIKING',
	'VILLAS',
	'VIN',
	'VIP',
	'VIRGIN',
	'VISA',
	'VISION',
	'VIVA',
	'VIVO',
	'VLAANDEREN',
	'VN',
	'VODKA',
	'VOLVO',
	'VOTE',
	'VOTING',
	'VOTO',
	'VOYAGE',
	'VU',
	'WALES',
	'WALMART',
	'WALTER',
	'WANG',
	'WANGGOU',
	'WATCH',
	'WATCHES',
	'WEATHER',
	'WEATHERCHANNEL',
	'WEBCAM',
	'WEBER',
	'WEBSITE',
	'WED',
	'WEDDING',
	'WEIBO',
	'WEIR',
	'WF',
	'WHOSWHO',
	'WIEN',
	'WIKI',
	'WILLIAMHILL',
	'WIN',
	'WINDOWS',
	'WINE',
	'WINNERS',
	'WME',
	'WOLTERSKLUWER',
	'WOODSIDE',
	'WORK',
	'WORKS',
	'WORLD',
	'WOW',
	'WS',
	'WTC',
	'WTF',
	'XBOX',
	'XEROX',
	'XIHUAN',
	'XIN',
	'XN--11B4C3D',
	'XN--1CK2E1B',
	'XN--1QQW23A',
	'XN--2SCRJ9C',
	'XN--30RR7Y',
	'XN--3BST00M',
	'XN--3DS443G',
	'XN--3E0B707E',
	'XN--3HCRJ9C',
	'XN--3PXU8K',
	'XN--42C2D9A',
	'XN--45BR5CYL',
	'XN--45BRJ9C',
	'XN--45Q11C',
	'XN--4DBRK0CE',
	'XN--4GBRIM',
	'XN--54B7FTA0CC',
	'XN--55QW42G',
	'XN--55QX5D',
	'XN--5SU34J936BGSG',
	'XN--5TZM5G',
	'XN--6FRZ82G',
	'XN--6QQ986B3XL',
	'XN--80ADXHKS',
	'XN--80AO21A',
	'XN--80AQECDR1A',
	'XN--80ASEHDB',
	'XN--80ASWG',
	'XN--8Y0A063A',
	'XN--90A3AC',
	'XN--90AE',
	'XN--90AIS',
	'XN--9DBQ2A',
	'XN--9ET52U',
	'XN--9KRT00A',
	'XN--B4W605FERD',
	'XN--BCK1B9A5DRE4C',
	'XN--C1AVG',
	'XN--C2BR7G',
	'XN--CCK2B3B',
	'XN--CCKWCXETD',
	'XN--CG4BKI',
	'XN--CLCHC0EA0B2G2A9GCD',
	'XN--CZR694B',
	'XN--CZRS0T',
	'XN--CZRU2D',
	'XN--D1ACJ3B',
	'XN--D1ALF',
	'XN--E1A4C',
	'XN--ECKVDTC9D',
	'XN--EFVY88H',
	'XN--FCT429K',
	'XN--FHBEI',
	'XN--FIQ228C5HS',
	'XN--FIQ64B',
	'XN--FIQS8S',
	'XN--FIQZ9S',
	'XN--FJQ720A',
	'XN--FLW351E',
	'XN--FPCRJ9C3D',
	'XN--FZC2C9E2C',
	'XN--FZYS8D69UVGM',
	'XN--G2XX48C',
	'XN--GCKR3F0F',
	'XN--GECRJ9C',
	'XN--GK3AT1E',
	'XN--H2BREG3EVE',
	'XN--H2BRJ9C',
	'XN--H2BRJ9C8C',
	'XN--HXT814E',
	'XN--I1B6B1A6A2E',
	'XN--IMR513N',
	'XN--IO0A7I',
	'XN--J1AEF',
	'XN--J1AMH',
	'XN--J6W193G',
	'XN--JLQ480N2RG',
	'XN--JVR189M',
	'XN--KCRX77D1X4A',
	'XN--KPRW13D',
	'XN--KPRY57D',
	'XN--KPUT3I',
	'XN--L1ACC',
	'XN--LGBBAT1AD8J',
	'XN--MGB9AWBF',
	'XN--MGBA3A3EJT',
	'XN--MGBA3A4F16A',
	'XN--MGBA7C0BBN0A',
	'XN--MGBAAM7A8H',
	'XN--MGBAB2BD',
	'XN--MGBAH1A3HJKRD',
	'XN--MGBAI9AZGQP6J',
	'XN--MGBAYH7GPA',
	'XN--MGBBH1A',
	'XN--MGBBH1A71E',
	'XN--MGBC0A9AZCG',
	'XN--MGBCA7DZDO',
	'XN--MGBCPQ6GPA1A',
	'XN--MGBERP4A5D4AR',
	'XN--MGBGU82A',
	'XN--MGBI4ECEXP',
	'XN--MGBPL2FH',
	'XN--MGBT3DHD',
	'XN--MGBTX2B',
	'XN--MGBX4CD0AB',
	'XN--MIX891F',
	'XN--MK1BU44C',
	'XN--MXTQ1M',
	'XN--NGBC5AZD',
	'XN--NGBE9E0A',
	'XN--NGBRX',
	'XN--NODE',
	'XN--NQV7F',
	'XN--NQV7FS00EMA',
	'XN--NYQY26A',
	'XN--O3CW4H',
	'XN--OGBPF8FL',
	'XN--OTU796D',
	'XN--P1ACF',
	'XN--P1AI',
	'XN--PGBS0DH',
	'XN--PSSY2U',
	'XN--Q7CE6A',
	'XN--Q9JYB4C',
	'XN--QCKA1PMC',
	'XN--QXA6A',
	'XN--QXAM',
	'XN--RHQV96G',
	'XN--ROVU88B',
	'XN--RVC1E0AM3E',
	'XN--S9BRJ9C',
	'XN--SES554G',
	'XN--T60B56A',
	'XN--TCKWE',
	'XN--TIQ49XQYJ',
	'XN--UNUP4Y',
	'XN--VERMGENSBERATER-CTB',
	'XN--VERMGENSBERATUNG-PWB',
	'XN--VHQUV',
	'XN--VUQ861B',
	'XN--W4R85EL8FHU5DNRA',
	'XN--W4RS40L',
	'XN--WGBH1C',
	'XN--WGBL6A',
	'XN--XHQ521B',
	'XN--XKC2AL3HYE2A',
	'XN--XKC2DL3A5EE0H',
	'XN--Y9A3AQ',
	'XN--YFRO4I67O',
	'XN--YGBI2AMMX',
	'XN--ZFR164B',
	'XXX',
	'XYZ',
	'YACHTS',
	'YAHOO',
	'YAMAXUN',
	'YANDEX',
	'YE',
	'YODOBASHI',
	'YOGA',
	'YOKOHAMA',
	'YOU',
	'YOUTUBE',
	'YT',
	'YUN',
	'ZA',
	'ZAPPOS',
	'ZARA',
	'ZERO',
	'ZIP',
	'ZM',
	'ZONE',
	'ZUERICH',
	'ZW',
);

1; # End of Domain::Sift::Match
